var INPUT_SHORTCUT_TYPES=["button","text","submit","color","url","password","hidden","file","number","email","reset","date","checkbox","select","radio"];function bootpopup(t){if(!(this instanceof bootpopup))return new bootpopup(t);var b=this;this.formid="bootpopup-form"+String(Math.random()).substr(2),this.options={title:document.title,showclose:!0,size:"normal",size_labels:"col-sm-4",size_inputs:"col-sm-8",content:[],onsubmit:"close",buttons:["close"],before:function(){},dismiss:function(){},close:function(){},ok:function(){},cancel:function(){},yes:function(){},no:function(){},complete:function(){},submit:function(t){return b.callback(b.options.onsubmit,t),!1}},this.addOptions=function(t){var o=[];for(var i in t)i in this.options&&(this.options[i]=t[i]),0<=["close","ok","cancel","yes","no"].indexOf(i)&&o.push(i);return 0<o.length&&("buttons"in t||(this.options.buttons=[]),o.forEach(function(t){b.options.buttons.indexOf(t)<0&&b.options.buttons.push(t)})),"string"!=typeof t.onsubmit&&(0<this.options.buttons.indexOf("close")?this.options.onsubmit="close":0<this.options.buttons.indexOf("ok")?this.options.onsubmit="ok":0<this.options.buttons.indexOf("yes")&&(this.options.onsubmit="yes")),this.options},this.setOptions=function(t){return this.options=t,this.options},this.create=function(){var t="modal-dialog";for(var o in"large"==this.options.size&&(t+=" modal-lg"),"small"==this.options.size&&(t+=" modal-sm"),this.modal=$('<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="bootpopup-title"></div>'),this.dialog=$("<div></div>",{class:t,role:"document"}),this.content=$('<div class="modal-content"></div>'),this.dialog.append(this.content),this.modal.append(this.dialog),this.header=$('<div class="modal-header"></div>'),this.options.showclose&&this.header.append('<button type="button" class="bootpopup-button close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>'),this.header.append('<h4 class="modal-title" id="bootpopup-title">'+this.options.title+"</h4>"),this.content.append(this.header),this.body=$('<div class="modal-body"></div>'),this.form=$("<form></form>",{id:this.formid,class:"form-horizontal",submit:function(t){return b.options.submit(t)}}),this.body.append(this.form),this.content.append(this.body),this.options.content){var i=this.options.content[o];switch(typeof i){case"string":this.form.append(i);break;case"object":for(var s in i){var n=i[s];for(var e in n)"function"==typeof n[e]&&(n[e]="("+n[e]+")(this)");if(0<=INPUT_SHORTCUT_TYPES.indexOf(s)&&(n.type=s,s="input"),"input"==s){var a;switch("checkbox"===n.type&&void 0===n.class&&(n.class=""),n.id=void 0===n.id?"bootpopup-input"+String(Math.random()).substr(2):n.id,n.class=void 0===n.class?"form-control":n.class,n.type=void 0===n.type?"text":n.type,n.type){case"checkbox":a=$('<div class="checkbox"></div>').append($("<label></label>").append($("<input />",n)).append(n.label)),n.label="";break;case"select":for(var p in a=$("<select></select>",n),n.options)a.append($("<option></option>",{value:p}).append(n.options[p]));break;case"radio":for(var p in a=[],n.options)a.push($('<div class="radio"></div>',n).append($("<label></label>").append($("<input />",{type:"radio",name:n.name,value:p})).append(n.options[p])));break;default:a=$("<input />",n)}var c=$('<div class="form-group"></div>').appendTo(this.form);$("<label></label>",{for:n.id,class:"control-label "+this.options.size_labels,text:n.label}).appendTo(c);var l=$("<div></div>",{class:this.options.size_inputs});l.append(a),c.append(l)}else this.form.append($("<"+s+"></"+s+">",n))}break;default:throw"Invalid entry type"}}for(var r in this.footer=$('<div class="modal-footer"></div>'),this.content.append(this.footer),this.options.buttons){var d=this.options.buttons[r],u="",h="";switch(d){case"close":u="btn-primary",h="Close";break;case"ok":u="btn-primary",h="OK";break;case"cancel":u="btn-default",h="Cancel";break;case"yes":u="btn-primary",h="Yes";break;case"no":u="btn-default",h="No"}var f=$("<button></button>",{type:"button",text:h,class:"btn "+u,"data-dismiss":"modal","data-callback":d,"data-form":this.formid,click:function(t){var o=$(t.target).data("callback");b.callback(o,t)}});switch(this.footer.append(f),d){case"close":this.btnClose=f;break;case"ok":this.btnOk=f;break;case"cancel":this.btnCancel=f;break;case"yes":this.btnYes=f;break;case"no":this.btnNo=f}}this.modal.on("hide.bs.modal",this.options.dismiss),this.modal.on("hidden.bs.modal",function(t){b.options.complete(t),b.modal.remove()}),!1===this.options.showclose&&this.modal.attr("data-backdrop","static"),$(document.body).append(this.modal)},this.show=function(){this.options.before(this),this.modal.modal()},this.data=function(){var t={},o=this.form.serializeArray();for(var i in o){var s=o[i].name,n=o[i].value;void 0===t[s]?t[s]=n:(Array.isArray(t[s])||(t[s]=[t[s]]),t[s].push(n))}return t},this.callback=function(t,o){var i=this.options[t];if("function"==typeof i){var s=this.form.serializeArray(),n=i(this.data(),s,o);return this.modal.modal("hide"),n}},this.dismiss=function(){this.callback("dismiss")},this.submit=function(){this.callback("submit")},this.close=function(){this.callback("close")},this.ok=function(){this.callback("ok")},this.cancel=function(){this.callback("cancel")},this.yes=function(){this.callback("yes")},this.no=function(){this.callback("no")},this.addOptions(t),this.create(),this.show()}bootpopup.alert=function(t,o,i){return"function"==typeof o&&(i=o),"string"!=typeof o&&(o=document.title),"function"!=typeof i&&(i=function(){}),bootpopup({title:o,content:[{p:{text:t}}],dismiss:function(){i()}})},bootpopup.confirm=function(t,o,i){"function"==typeof o&&(i=o),"string"!=typeof o&&(o=document.title),"function"!=typeof i&&(i=function(){});var s=!1;return bootpopup({title:o,showclose:!1,content:[{p:{text:t}}],buttons:["no","yes"],yes:function(){s=!0},dismiss:function(){i(s)}})},bootpopup.prompt=function(t,o,i,s,n){var e=function(){};"function"==typeof o&&(e=o),"function"==typeof i&&(e=i),"function"==typeof s&&(e=s),"function"==typeof n&&(e=n),"object"==typeof t&&(s=i,i=o,o=null),"string"!=typeof i&&(i="Please, provide values for:"),"string"!=typeof s&&(s=document.title);var a=[{p:{text:i}}];if("object"==typeof t)t.forEach(function(t){var o=null;"string"==typeof t&&(o=t),null!==t&&"object"==typeof t&&"string"==typeof t.label&&("string"!=typeof t.name&&(t.name=t.label.toLowerCase().replace(/\s+/g,"-")),"string"!=typeof t.type&&(t.type="text"),o={input:t}),null!==o&&a.push(o)});else{"string"!=typeof o&&(o="text"),a.push({input:{type:o,name:"value",label:t}});var p=e;e=function(t){p(t.value)}}return bootpopup({title:s,content:a,buttons:["cancel","ok"],ok:function(t){e(t)}})},"function"==typeof define&&define(["jquery","bootstrap"],function(){return bootpopup});
