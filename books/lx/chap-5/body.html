
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Lightning Data Service Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../chap-30/body.html" />
    
    
    <link rel="prev" href="../chap-11/lcc.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../chap-1/body.html">
            
                <a href="../chap-1/body.html">
            
                    
                    Lightning Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../chap-2/body.html">
            
                <a href="../chap-2/body.html">
            
                    
                    Classic Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../chap-11/body.html">
            
                <a href="../chap-11/body.html">
            
                    
                    Migration to Lightning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../chap-11/actions.html">
            
                <a href="../chap-11/actions.html">
            
                    
                    Actions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../chap-11/global-actions.steps.html">
            
                <a href="../chap-11/global-actions.steps.html">
            
                    
                    Global Actions Demo Steps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../chap-11/object-specific-actions.steps.html">
            
                <a href="../chap-11/object-specific-actions.steps.html">
            
                    
                    Object-Specific Actions Demo Steps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../chap-11/validate-field-values.steps.html">
            
                <a href="../chap-11/validate-field-values.steps.html">
            
                    
                    Validate Field Values Demo Steps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../chap-11/redirect-vf.steps.html">
            
                <a href="../chap-11/redirect-vf.steps.html">
            
                    
                    VF page redirect with field values
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../chap-11/custom-link.html">
            
                <a href="../chap-11/custom-link.html">
            
                    
                    Custom Link
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../chap-11/lex-app.html">
            
                <a href="../chap-11/lex-app.html">
            
                    
                    Lightning App
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.1" data-path="../chap-11/lex-app-mgr.html">
            
                <a href="../chap-11/lex-app-mgr.html">
            
                    
                    App Manager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.2" data-path="../chap-11/lex-list-view.html">
            
                <a href="../chap-11/lex-list-view.html">
            
                    
                    List Views
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.3" data-path="../chap-11/lex-compact-lo.html">
            
                <a href="../chap-11/lex-compact-lo.html">
            
                    
                    Compact Layouts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.4" data-path="../chap-11/lex-page-lo.html">
            
                <a href="../chap-11/lex-page-lo.html">
            
                    
                    Page Layouts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.5" data-path="../chap-11/record-types.html">
            
                <a href="../chap-11/record-types.html">
            
                    
                    Record Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../chap-15/build-comp.html">
            
                <a href="../chap-15/build-comp.html">
            
                    
                    Building components
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.1" data-path="../chap-15/buttons.html">
            
                <a href="../chap-15/buttons.html">
            
                    
                    Playing with buttons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.2" data-path="../chap-15/expr.html">
            
                <a href="../chap-15/expr.html">
            
                    
                    Expressions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.3" data-path="../chap-15/value-providers.html">
            
                <a href="../chap-15/value-providers.html">
            
                    
                    Value Providers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.4" data-path="../chap-15/lightning.html">
            
                <a href="../chap-15/lightning.html">
            
                    
                    More lightning:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.5" data-path="../chap-32/page-template.html">
            
                <a href="../chap-32/page-template.html">
            
                    
                    Custom Page Template
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../chap-20/test-automation.html">
            
                <a href="../chap-20/test-automation.html">
            
                    
                    Lightning Testing Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../chap-20/qa-automation.html">
            
                <a href="../chap-20/qa-automation.html">
            
                    
                    QA Automation
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../chap-22/homepage-profile-based.html">
            
                <a href="../chap-22/homepage-profile-based.html">
            
                    
                    Profile based Home Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../chap-23/canvasApp.html">
            
                <a href="../chap-23/canvasApp.html">
            
                    
                    Canvas App
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../chap-23/ea-canvas.html">
            
                <a href="../chap-23/ea-canvas.html">
            
                    
                    EA and Other Apps
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../chap-24/rest-calls.html">
            
                <a href="../chap-24/rest-calls.html">
            
                    
                    Consuming REST services
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../chap-25/lex-dx.html">
            
                <a href="../chap-25/lex-dx.html">
            
                    
                    SFDX & Lightning Dev
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../chap-26/dx-packaging.html">
            
                <a href="../chap-26/dx-packaging.html">
            
                    
                    SFDX Packaging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../chap-27/dh-app.html">
            
                <a href="../chap-27/dh-app.html">
            
                    
                    SFDX DreamHouse App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../chap-29/trainingTrackerApp.html">
            
                <a href="../chap-29/trainingTrackerApp.html">
            
                    
                    SFDX TrainingTracker App
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../chap-11/lcc.html">
            
                <a href="../chap-11/lcc.html">
            
                    
                    Lightning Configuration Converter
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.2" data-path="body.html">
            
                <a href="body.html">
            
                    
                    Lightning Data Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../chap-30/body.html">
            
                <a href="../chap-30/body.html">
            
                    
                    Lightning Out
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../chap-28/perf.html">
            
                <a href="../chap-28/perf.html">
            
                    
                    Performance Tips
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../chap-31/sc.html">
            
                <a href="../chap-31/sc.html">
            
                    
                    Secure Coding
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../chap-12/body.html">
            
                <a href="../chap-12/body.html">
            
                    
                    Security
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../chap-12/LockerService.html">
            
                <a href="../chap-12/LockerService.html">
            
                    
                    LockerService
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../chap-12/lx-container.html">
            
                <a href="../chap-12/lx-container.html">
            
                    
                    Lightning Container Component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.3" data-path="../chap-12/postMessage.html">
            
                <a href="../chap-12/postMessage.html">
            
                    
                    window.postMessage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../aura/aura.html">
            
                <a href="../aura/aura.html">
            
                    
                    Aura UI Framework
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../perf/chap-1.html">
            
                <a href="../perf/chap-1.html">
            
                    
                    Performance Best Practices
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="../sfdx/sfdx.html">
            
                <a href="../sfdx/sfdx.html">
            
                    
                    SFDX
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1.1" data-path="../sfdx/project-generator.html">
            
                <a href="../sfdx/project-generator.html">
            
                    
                    Project Generator
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="11.1" data-path="../chap-12/ea-static-binding.html">
            
                <a href="../chap-12/ea-static-binding.html">
            
                    
                    EA Binding Notes 
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="12.1" data-path="../chap-99/errors.html">
            
                <a href="../chap-99/errors.html">
            
                    
                    Errors
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="13.1" data-path="../ref/ref.html">
            
                <a href="../ref/ref.html">
            
                    
                    References
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Lightning Data Service</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="lightning-data-service">Lightning Data service</h2>
<p>We can use Lightning Data Service to:</p>
<ul>
<li>load</li>
<li>create</li>
<li>edit</li>
<li>delete</li>
</ul>
<p>a record in your component without requiring Apex code.</p>
<ul>
<li>Handles <strong>sharing rules and field-level security </strong>for you.</li>
<li>Improves <strong>performance</strong> and user interface consistency.</li>
<li>Similar to Visualforce standard Controller</li>
<li><p>Whenever possible, use Lightning Data Service to <strong>read and modify</strong> Salesforce data in your components.</p>
</li>
<li><p>Read-only access can be <strong>entirely declarative</strong> in your component&#x2019;s markup to eliminate Apex code entirely.</p>
</li>
<li>Your data access code is consolidated into your component, which significantly reduces complexity.</li>
</ul>
<h3 id="benefits">Benefits</h3>
<ul>
<li>Built on highly efficient local storage that&#x2019;s <strong>shared across all components</strong> that use it.</li>
<li>Records loaded in Lightning Data Service are <strong>cached and shared across components</strong>.<ul>
<li>Components accessing the same record see <strong>significant performance improvements</strong>, because a record is <strong>loaded only once</strong>, no matter how many components are using it.</li>
<li>Shared records also improve <strong>user interface consistency</strong>.</li>
<li>When one component updates a record, the other components using it are <strong>notified, and in most cases, refresh automatically</strong>.</li>
</ul>
</li>
</ul>
<h3 id="loading-record--forcerecorddata">Loading Record  force:recordData</h3>
<pre><code class="lang-xml">
<span class="hljs-comment">&lt;!--

flexipage:availableForRecordHome:
 This component can be added to:
    record home page in the Lightning App Builder
    (Lightning Record Page)

force:lightningQuickActionWithoutHeader:
    as a custom action
    (Lightning Quick Action)

force:hasRecordId:
    The record ID is supplied by the implicit recordId attribute
    added by the force:hasRecordId interface.


&lt;aura:component
implements=&quot;flexipage:availableForRecordHome,force:lightningQuickActionWithoutHeader, force:hasRecordId&quot;&gt;



    &lt;aura:attribute name=&quot;record&quot; type=&quot;Object&quot;/&gt;
    &lt;aura:attribute name=&quot;simpleRecord&quot; type=&quot;Object&quot;/&gt;
    &lt;aura:attribute name=&quot;recordError&quot; type=&quot;String&quot;/&gt;

    &lt;!--
      layoutType:
      All fields on that layoutType are loaded for the record

      Or  provide fields attribute to specify the list of fields
      to load with the fields attribute

      example:
      fields=&quot;Name,BillingCity,BillingState&quot;
      -------------
      recordId:
      The ID of the record to load
      -------------
      targetRecord:
      targetFields:
      Which component attribute to assign the loaded record


    --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">force:recordData</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;recordLoader&quot;</span>
      <span class="hljs-attr">recordId</span>=<span class="hljs-string">&quot;{!v.recordId}&quot;</span>
      <span class="hljs-attr">layoutType</span>=<span class="hljs-string">&quot;FULL&quot;</span>



      <span class="hljs-attr">targetRecord</span>=<span class="hljs-string">&quot;{!v.record}&quot;</span>
      <span class="hljs-attr">targetFields</span>=<span class="hljs-string">&quot;{!v.simpleRecord}&quot;</span>
      <span class="hljs-attr">targetError</span>=<span class="hljs-string">&quot;{!v.recordError}&quot;</span>

      <span class="hljs-attr">recordUpdated</span>=<span class="hljs-string">&quot;{!c.handleRecordUpdated}&quot;</span>
      /&gt;</span>

    <span class="hljs-comment">&lt;!-- Display a header with details about the record --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slds-page-header&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;banner&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slds-text-heading_label&quot;</span>&gt;</span>{!v.simpleRecord.Name}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slds-page-header__title slds-m-right_small
            slds-truncate slds-align-left&quot;</span>&gt;</span>
            {!v.simpleRecord.BillingCity}, {!v.simpleRecord.BillingState}
        <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Display Lightning Data Service errors, if any --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:if</span> <span class="hljs-attr">isTrue</span>=<span class="hljs-string">&quot;{!not(empty(v.recordError))}&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;recordError&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ui:message</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Error&quot;</span> <span class="hljs-attr">severity</span>=<span class="hljs-string">&quot;error&quot;</span> <span class="hljs-attr">closable</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span>
                {!v.recordError}
            <span class="hljs-tag">&lt;/<span class="hljs-name">ui:message</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">aura:if</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<h4 id="controller">Controller</h4>
<pre><code class="lang-js">({
    handleRecordUpdated: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> eventParams = event.getParams();
        <span class="hljs-keyword">if</span>(eventParams.changeType === <span class="hljs-string">&quot;LOADED&quot;</span>) {
           <span class="hljs-comment">// record is loaded (render other component which needs record data value)</span>
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Record is loaded successfully.&quot;</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(eventParams.changeType === <span class="hljs-string">&quot;CHANGED&quot;</span>) {
            <span class="hljs-comment">// record is changed</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(eventParams.changeType === <span class="hljs-string">&quot;REMOVED&quot;</span>) {
            <span class="hljs-comment">// record is deleted</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(eventParams.changeType === <span class="hljs-string">&quot;ERROR&quot;</span>) {
            <span class="hljs-comment">// there&#x2019;s an error while loading, saving, or deleting the record</span>
        }
    }
})
</code></pre>
<h3 id="how-to-use-this-in-lightning-app-builder">How to use this in Lightning App Builder</h3>
<h4 id="component">Component</h4>
<p><img src="img/dc-ldscomp.png" alt="How it is in Developer Console"></p>
<h4 id="lightning-app-builder">Lightning App Builder</h4>
<p><img src="img/lds-app-builder-1.png" alt="How to use this in Lightning App Builder -1"></p>
<p><img src="img/lds-app-builder-2.png" alt="How to use this in Lightning App Builder -2"></p>
<p><img src="img/lds-app-builder-3.png" alt="How to use this in Lightning App Builder -3"></p>
<p><img src="img/lds-app-builder-4.png" alt="How to use this in Lightning App Builder -4"></p>
<p><img src="img/lds-app-builder-5.png" alt="How to use this in Lightning App Builder -5"></p>
<h3 id="saving-a-record">Saving a Record</h3>
<p>Two cases:</p>
<ul>
<li>Save changes to an existing record<ul>
<li><code>mode=&quot;EDIT&quot;</code> and use <code>saveRecord</code> on <code>force.recordData</code></li>
</ul>
</li>
</ul>
<ul>
<li>Create and Save a new record</li>
</ul>
<p>To save a record using Lightning Data Service:</p>
<p> call <code>saveRecord</code> on the <code>force:recordData</code> component,
and pass in a callback function to be invoked after the save operation completes.</p>
<pre><code class="lang-js">
  handleSaveRecord: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
         <span class="hljs-comment">// saveRecord</span>
          component.find(<span class="hljs-string">&quot;recordHandler&quot;</span>).saveRecord($A.getCallback(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">saveResult</span>) </span>{
              <span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> If you want a specific behavior(an action or UI behavior) when this action is successful</span>
              <span class="hljs-comment">// then handle that in a callback (generic logic when record is changed should be handled in recordUpdated event handler)</span>
              <span class="hljs-keyword">if</span> (saveResult.state === <span class="hljs-string">&quot;SUCCESS&quot;</span> || saveResult.state === <span class="hljs-string">&quot;DRAFT&quot;</span>) {
                  <span class="hljs-comment">// handle component related logic in event handler</span>
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (saveResult.state === <span class="hljs-string">&quot;INCOMPLETE&quot;</span>) {
                  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;User is offline, device doesn&apos;t support drafts.&quot;</span>);
              } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (saveResult.state === <span class="hljs-string">&quot;ERROR&quot;</span>) {
                  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Problem saving record, error: &apos;</span> + <span class="hljs-built_in">JSON</span>.stringify(saveResult.error));
              } <span class="hljs-keyword">else</span> {
                  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Unknown problem, state: &apos;</span> + saveResult.state + <span class="hljs-string">&apos;, error: &apos;</span> + <span class="hljs-built_in">JSON</span>.stringify(saveResult.error));
              }
          }));
      }
</code></pre>
<pre><code class="lang-xml">  &lt;&lt;aura:component implements=&quot;flexipage:availableForRecordHome,force:hasRecordId&quot;&gt;

    &lt;aura:attribute name=&quot;record&quot; type=&quot;Object&quot;/&gt;
    &lt;aura:attribute name=&quot;simpleRecord&quot; type=&quot;Object&quot;/&gt;
    &lt;aura:attribute name=&quot;recordError&quot; type=&quot;String&quot;/&gt;

    &lt;force:recordData aura:id=&quot;recordHandler&quot;
      recordId=&quot;{!v.recordId}&quot;
      layoutType=&quot;FULL&quot;
      targetRecord=&quot;{!v.record}&quot;
      targetFields=&quot;{!v.simpleRecord}&quot;
      targetError=&quot;{!v.recordError}&quot;

      mode=&quot;EDIT&quot;

      recordUpdated=&quot;{!c.handleRecordUpdated}&quot;

      /&gt;

    &lt;!-- Display a header with details about the record --&gt;
    &lt;div class=&quot;slds-page-header&quot; role=&quot;banner&quot;&gt;
        &lt;p class=&quot;slds-text-heading_label&quot;&gt;Edit Record&lt;/p&gt;
        &lt;h1 class=&quot;slds-page-header__title slds-m-right_small
            slds-truncate slds-align-left&quot;&gt;{!v.simpleRecord.Name}&lt;/h1&gt;
    &lt;/div&gt;

    &lt;!-- Display Lightning Data Service errors, if any --&gt;
    &lt;aura:if isTrue=&quot;{!not(empty(v.recordError))}&quot;&gt;
        &lt;div class=&quot;recordError&quot;&gt;
            &lt;ui:message title=&quot;Error&quot; severity=&quot;error&quot; closable=&quot;true&quot;&gt;
                {!v.recordError}
            &lt;/ui:message&gt;
        &lt;/div&gt;
    &lt;/aura:if&gt;

    &lt;!-- Display an editing form --&gt;
    &lt;lightning:input aura:id=&quot;recordName&quot; name=&quot;recordName&quot; label=&quot;Name&quot;
                  value=&quot;{!v.simpleRecord.Name}&quot; required=&quot;true&quot;/&gt;

     &lt;lightning:button label=&quot;Save Record&quot; onclick=&quot;{!c.handleSaveRecord}&quot;

               variant=&quot;brand&quot; class=&quot;slds-m-top_medium&quot;/&gt;
&lt;/aura:component&gt;
</code></pre>
<pre><code class="lang-js">  <span class="hljs-comment">/**
     * Control the component behavior here when record is changed (via any component)
     */</span>
    handleRecordUpdated: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> eventParams = event.getParams();
        <span class="hljs-keyword">if</span>(eventParams.changeType === <span class="hljs-string">&quot;CHANGED&quot;</span>) {
            <span class="hljs-comment">// get the fields that changed for this record</span>
            <span class="hljs-keyword">var</span> changedFields = eventParams.changedFields;
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Fields that are changed: &apos;</span> + <span class="hljs-built_in">JSON</span>.stringify(changedFields));
            <span class="hljs-comment">// record is changed, so refresh the component (or other component logic)</span>
            <span class="hljs-keyword">var</span> resultsToast = $A.get(<span class="hljs-string">&quot;e.force:showToast&quot;</span>);
            resultsToast.setParams({
                <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;Saved&quot;</span>,
                <span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;The record was updated.&quot;</span>
            });
            resultsToast.fire();

        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(eventParams.changeType === <span class="hljs-string">&quot;LOADED&quot;</span>) {
            <span class="hljs-comment">// record is loaded in the cache</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(eventParams.changeType === <span class="hljs-string">&quot;REMOVED&quot;</span>) {
            <span class="hljs-comment">// record is deleted and removed from the cache</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(eventParams.changeType === <span class="hljs-string">&quot;ERROR&quot;</span>) {
            <span class="hljs-comment">// there&#x2019;s an error while loading, saving or deleting the record</span>
        }
    }
</code></pre>
<h3 id="creating-a-record">Creating a Record</h3>
<ul>
<li><p>Declare <code>force:recordData</code> without assigning a recordId.</p>
</li>
<li><p>Load a record template by calling the <code>getNewRecord</code> function on <code>force:recordData</code></p>
</li>
<li><code>`getNewRecord</code> doesn&#x2019;t return a result. It simply prepares an empty record and assigns it to the targetRecord attribute,
which is used by the contact form in the component&#x2019;s markup.</li>
</ul>
<ul>
<li><p>Apply values to the new record</p>
</li>
<li><p>Save the record by calling the <code>saveRecord</code> function on <code>force:recordData</code>.</p>
</li>
</ul>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span> <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;flexipage:availableForRecordHome, force:hasRecordId&quot;</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;newContact&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Object&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;simpleNewContact&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Object&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;newContactError&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;String&quot;</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">aura:handler</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;init&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{!this}&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;{!c.doInit}&quot;</span>/&gt;</span>

    <span class="hljs-comment">&lt;!-- note there is no recordId: recordId=&quot;{!v.recordId} here --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">force:recordData</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;contactRecordCreator&quot;</span>
                      <span class="hljs-attr">layoutType</span>=<span class="hljs-string">&quot;FULL&quot;</span>
                      <span class="hljs-attr">targetRecord</span>=<span class="hljs-string">&quot;{!v.newContact}&quot;</span>
                      <span class="hljs-attr">targetFields</span>=<span class="hljs-string">&quot;{!v.simpleNewContact}&quot;</span>
                      <span class="hljs-attr">targetError</span>=<span class="hljs-string">&quot;{!v.newContactError}&quot;</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slds-page-header&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;banner&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slds-text-heading_label&quot;</span>&gt;</span>Create Contact<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Display Lightning Data Service errors --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:if</span> <span class="hljs-attr">isTrue</span>=<span class="hljs-string">&quot;{!not(empty(v.newContactError))}&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;recordError&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ui:message</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Error&quot;</span> <span class="hljs-attr">severity</span>=<span class="hljs-string">&quot;error&quot;</span> <span class="hljs-attr">closable</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span>
                {!v.newContactError}
            <span class="hljs-tag">&lt;/<span class="hljs-name">ui:message</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">aura:if</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Display the new contact form --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slds-form_stacked&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:input</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;contactField&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;firstName&quot;</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;First Name&quot;</span>
                         <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{!v.simpleNewContact.FirstName}&quot;</span> <span class="hljs-attr">required</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:input</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;contactField&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;lastname&quot;</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;Last Name&quot;</span>
                      <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{!v.simpleNewContact.LastName}&quot;</span> <span class="hljs-attr">required</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:input</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;contactField&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;title&quot;</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;Title&quot;</span>
                      <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{!v.simpleNewContact.Title}&quot;</span> /&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;Save contact&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.handleSaveContact}&quot;</span>
                   <span class="hljs-attr">variant</span>=<span class="hljs-string">&quot;brand&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slds-m-top_medium&quot;</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<pre><code class="lang-js">
({
    doInit: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-comment">// Prepare a new record from template</span>
        component.find(<span class="hljs-string">&quot;contactRecordCreator&quot;</span>).getNewRecord(

            <span class="hljs-string">&quot;Contact&quot;</span>, <span class="hljs-comment">// sObject type (objectApiName)</span>

            <span class="hljs-literal">null</span>,      <span class="hljs-comment">// recordTypeId</span>
            <span class="hljs-comment">// If not specified, the default record type for the object is used,</span>
            <span class="hljs-comment">// as defined in the user&#x2019;s profile.</span>

            <span class="hljs-literal">false</span>,     <span class="hljs-comment">// skip cache?</span>
            <span class="hljs-comment">// Whether to load the record template from the server instead of the client-side Lightning Data Service cache.</span>
            <span class="hljs-comment">// Defaults to false</span>

            <span class="hljs-comment">// callback function invoked after the empty record is created. This function receives no arguments.</span>
            <span class="hljs-comment">/*
             The callback passed to getNewRecord() must be wrapped in $A.getCallback()
              to ensure correct access context when the callback is invoked.
             If the callback is passed in without being wrapped in $A.getCallback(),
              any attempt to access private attributes of your component results in access check failures.
            */</span>

            <span class="hljs-comment">/*

            Even if you&#x2019;re not accessing private attributes,
              it&#x2019;s a best practice to always wrap the callback function for getNewRecord() in $A.getCallback(). Never mix (contexts), never worry.
            */</span>

            $A.getCallback(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">var</span> rec = component.get(<span class="hljs-string">&quot;v.newContact&quot;</span>);
                <span class="hljs-keyword">var</span> error = component.get(<span class="hljs-string">&quot;v.newContactError&quot;</span>);
                <span class="hljs-keyword">if</span>(error || (rec === <span class="hljs-literal">null</span>)) {
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Error initializing record template: &quot;</span> + error);
                    <span class="hljs-keyword">return</span>;
                }
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Record template initialized: &quot;</span> + rec.sobjectType);
            })
        );
    },

    handleSaveContact: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">if</span>(helper.validateContactForm(component)) {
            component.set(<span class="hljs-string">&quot;v.simpleNewContact.AccountId&quot;</span>, component.get(<span class="hljs-string">&quot;v.recordId&quot;</span>));
            component.find(<span class="hljs-string">&quot;contactRecordCreator&quot;</span>).saveRecord(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">saveResult</span>) </span>{
                <span class="hljs-keyword">if</span> (saveResult.state === <span class="hljs-string">&quot;SUCCESS&quot;</span> || saveResult.state === <span class="hljs-string">&quot;DRAFT&quot;</span>) {
                    <span class="hljs-comment">// record is saved successfully</span>
                    <span class="hljs-keyword">var</span> resultsToast = $A.get(<span class="hljs-string">&quot;e.force:showToast&quot;</span>);
                    resultsToast.setParams({
                        <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;Saved&quot;</span>,
                        <span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;The record was saved.&quot;</span>
                    });
                    resultsToast.fire();

                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (saveResult.state === <span class="hljs-string">&quot;INCOMPLETE&quot;</span>) {
                    <span class="hljs-comment">// handle the incomplete state</span>
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;User is offline, device doesn&apos;t support drafts.&quot;</span>);
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (saveResult.state === <span class="hljs-string">&quot;ERROR&quot;</span>) {
                    <span class="hljs-comment">// handle the error state</span>
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Problem saving contact, error: &apos;</span> + <span class="hljs-built_in">JSON</span>.stringify(saveResult.error));
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Unknown problem, state: &apos;</span> + saveResult.state + <span class="hljs-string">&apos;, error: &apos;</span> + <span class="hljs-built_in">JSON</span>.stringify(saveResult.error));
                }
            });
        }
    }
})
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../chap-11/lcc.html" class="navigation navigation-prev " aria-label="Previous page: Lightning Configuration Converter">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../chap-30/body.html" class="navigation navigation-next " aria-label="Next page: Lightning Out">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Lightning Data Service","level":"4.2","depth":1,"next":{"title":"Lightning Out","level":"4.3","depth":1,"path":"chap-30/body.md","ref":"chap-30/body.md","articles":[]},"previous":{"title":"Lightning Configuration Converter","level":"4.1","depth":1,"path":"chap-11/lcc.md","ref":"chap-11/lcc.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["youtube","adsense","livereload"],"pluginsConfig":{"youtube":{},"livereload":{},"search":{},"adsense":{"client":"ca-pub-5381915020912221","slot":"8656817479","format":"auto","element":".page-inner section","position":"top"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"chap-5/body.md","mtime":"2018-03-19T15:57:02.475Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2018-08-10T20:39:06.437Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-adsense/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

