
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Performance Tips Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../chap-31/sc.html" />
    
    
    <link rel="prev" href="../chap-30/body.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../chap-1/body.html">
            
                <a href="../chap-1/body.html">
            
                    
                    Lightning Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../chap-2/body.html">
            
                <a href="../chap-2/body.html">
            
                    
                    Classic Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../chap-11/body.html">
            
                <a href="../chap-11/body.html">
            
                    
                    Migration to Lightning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../chap-11/actions.html">
            
                <a href="../chap-11/actions.html">
            
                    
                    Actions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../chap-11/global-actions.steps.html">
            
                <a href="../chap-11/global-actions.steps.html">
            
                    
                    Global Actions Demo Steps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../chap-11/object-specific-actions.steps.html">
            
                <a href="../chap-11/object-specific-actions.steps.html">
            
                    
                    Object-Specific Actions Demo Steps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../chap-11/validate-field-values.steps.html">
            
                <a href="../chap-11/validate-field-values.steps.html">
            
                    
                    Validate Field Values Demo Steps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../chap-11/redirect-vf.steps.html">
            
                <a href="../chap-11/redirect-vf.steps.html">
            
                    
                    VF page redirect with field values
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../chap-11/custom-link.html">
            
                <a href="../chap-11/custom-link.html">
            
                    
                    Custom Link
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../chap-11/lex-app.html">
            
                <a href="../chap-11/lex-app.html">
            
                    
                    Lightning App
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.1" data-path="../chap-11/lex-app-mgr.html">
            
                <a href="../chap-11/lex-app-mgr.html">
            
                    
                    App Manager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.2" data-path="../chap-11/lex-list-view.html">
            
                <a href="../chap-11/lex-list-view.html">
            
                    
                    List Views
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.3" data-path="../chap-11/lex-compact-lo.html">
            
                <a href="../chap-11/lex-compact-lo.html">
            
                    
                    Compact Layouts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.4" data-path="../chap-11/lex-page-lo.html">
            
                <a href="../chap-11/lex-page-lo.html">
            
                    
                    Page Layouts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.5" data-path="../chap-11/record-types.html">
            
                <a href="../chap-11/record-types.html">
            
                    
                    Record Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../chap-15/build-comp.html">
            
                <a href="../chap-15/build-comp.html">
            
                    
                    Building components
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.1" data-path="../chap-15/buttons.html">
            
                <a href="../chap-15/buttons.html">
            
                    
                    Playing with buttons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.2" data-path="../chap-15/expr.html">
            
                <a href="../chap-15/expr.html">
            
                    
                    Expressions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.3" data-path="../chap-15/value-providers.html">
            
                <a href="../chap-15/value-providers.html">
            
                    
                    Value Providers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.4" data-path="../chap-15/lightning.html">
            
                <a href="../chap-15/lightning.html">
            
                    
                    More lightning:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.5" data-path="../chap-32/page-template.html">
            
                <a href="../chap-32/page-template.html">
            
                    
                    Custom Page Template
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../chap-20/test-automation.html">
            
                <a href="../chap-20/test-automation.html">
            
                    
                    Lightning Testing Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../chap-20/qa-automation.html">
            
                <a href="../chap-20/qa-automation.html">
            
                    
                    QA Automation
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../chap-22/homepage-profile-based.html">
            
                <a href="../chap-22/homepage-profile-based.html">
            
                    
                    Profile based Home Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../chap-23/canvasApp.html">
            
                <a href="../chap-23/canvasApp.html">
            
                    
                    Canvas App
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../chap-23/ea-canvas.html">
            
                <a href="../chap-23/ea-canvas.html">
            
                    
                    EA and Other Apps
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../chap-24/rest-calls.html">
            
                <a href="../chap-24/rest-calls.html">
            
                    
                    Consuming REST services
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../chap-25/lex-dx.html">
            
                <a href="../chap-25/lex-dx.html">
            
                    
                    SFDX & Lightning Dev
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../chap-26/dx-packaging.html">
            
                <a href="../chap-26/dx-packaging.html">
            
                    
                    SFDX Packaging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../chap-27/dh-app.html">
            
                <a href="../chap-27/dh-app.html">
            
                    
                    SFDX DreamHouse App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../chap-29/trainingTrackerApp.html">
            
                <a href="../chap-29/trainingTrackerApp.html">
            
                    
                    SFDX TrainingTracker App
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../chap-11/lcc.html">
            
                <a href="../chap-11/lcc.html">
            
                    
                    Lightning Configuration Converter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../chap-5/body.html">
            
                <a href="../chap-5/body.html">
            
                    
                    Lightning Data Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../chap-30/body.html">
            
                <a href="../chap-30/body.html">
            
                    
                    Lightning Out
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter active" data-level="5.1" data-path="perf.html">
            
                <a href="perf.html">
            
                    
                    Performance Tips
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../chap-31/sc.html">
            
                <a href="../chap-31/sc.html">
            
                    
                    Secure Coding
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../chap-12/body.html">
            
                <a href="../chap-12/body.html">
            
                    
                    Security
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../chap-12/LockerService.html">
            
                <a href="../chap-12/LockerService.html">
            
                    
                    LockerService
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../chap-12/lx-container.html">
            
                <a href="../chap-12/lx-container.html">
            
                    
                    Lightning Container Component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.3" data-path="../chap-12/postMessage.html">
            
                <a href="../chap-12/postMessage.html">
            
                    
                    window.postMessage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../aura/aura.html">
            
                <a href="../aura/aura.html">
            
                    
                    Aura UI Framework
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../perf/chap-1.html">
            
                <a href="../perf/chap-1.html">
            
                    
                    Performance Best Practices
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="../sfdx/sfdx.html">
            
                <a href="../sfdx/sfdx.html">
            
                    
                    SFDX
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1.1" data-path="../sfdx/project-generator.html">
            
                <a href="../sfdx/project-generator.html">
            
                    
                    Project Generator
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="11.1" data-path="../chap-12/ea-static-binding.html">
            
                <a href="../chap-12/ea-static-binding.html">
            
                    
                    EA Binding Notes 
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="12.1" data-path="../chap-99/errors.html">
            
                <a href="../chap-99/errors.html">
            
                    
                    Errors
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="13.1" data-path="../ref/ref.html">
            
                <a href="../ref/ref.html">
            
                    
                    References
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Performance Tips</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="performance-tips">Performance Tips</h2>
<h3 id="storable-actions--using-actionsetstorable">Storable Actions : Using action.setStorable();</h3>
<ul>
<li><p>Marks the actions as storable to quickly show cached data from client-side storage without waiting for a server trip.</p>
</li>
<li><p><code>refreshAge</code>: <strong>30 secs</strong></p>
</li>
<li><p><code>expirationAge</code>: <strong>900 secs = 15 min.</strong></p>
</li>
</ul>
<pre><code class="lang-js">
<span class="hljs-keyword">var</span> action = component.get(<span class="hljs-string">&quot;c.svrGetAccounts&quot;</span>);

action.setStorable(); <span class="hljs-comment">// here the magic happens # Step:6 in the animation below </span>
<span class="hljs-comment">// takes in opt parameter: ignoreExisting - default value = false</span>
<span class="hljs-comment">// set it true when you need to bypass the cache</span>
<span class="hljs-comment">//    useful: when you know that cached-data is invalid you wnat to ignore it, </span>
<span class="hljs-comment">//        so you do not use it on normal cases</span>

action.setCallback(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{ <span class="hljs-comment">// callback may be called twice as in sceneario:3 as shown below</span>
    <span class="hljs-comment">// use the response</span>
});

$A.enqueueAction(action);
</code></pre>
<style>

progress[value] {
  /* Reset the default appearance */
  -webkit-appearance: none;
  appearance: none;

  width: 500px;
  height: 40px;
  color:gray;
}
@-webkit-keyframes animate-stripes {
   100% { background-position: -100px 0px; }
}

@keyframes animate-stripes {
   100% { background-position: -100px 0px; }
}

progress[value]::-webkit-progress-value {
  background-image:
       -webkit-linear-gradient(-45deg, 
                               transparent 33%, rgba(0, 0, 0, .1) 33%, 
                               rgba(0,0, 0, .1) 66%, transparent 66%),
       -webkit-linear-gradient(top, 
                               rgba(255, 255, 255, .25), 
                               rgba(0, 0, 0, .25)),
       -webkit-linear-gradient(left, #09c, #f44);

    border-radius: 2px; 
    background-size: 35px 20px, 100% 100%, 100% 100%;
}

progress {
  text-align: left;
  font-size:10px;
  height:100px;
}
progress:after {
  content: 'cache age: ' attr(value) ' secs';
}
</style>

<progress value="901" max="900"></progress>



<p><img src="img/action-setStorable-0.gif" alt="action.setStorable-1"></p>
<progress value="20" max="900"></progress>


<p><img src="img/action-setStorable-2.gif" alt="action.setStorable-2"></p>
<progress value="35" max="900"></progress>

<p><img src="img/action-setStorable-3.gif" alt="action.setStorable-2"></p>
<h3 id="notes">Notes</h3>
<ol>
<li><p>A storable action might result in no call to the server. <strong>Never mark as storable an action that updates or deletes data.</strong>. Use it for non-mutable data (read-only). Since most server requests are read-only and idempotent, storable action will provide performance boost in these cases.</p>
</li>
<li><p>For storable actions in the cache, the framework returns the cached response immediately and also refreshes the data if it&#x2019;s stale. Therefore, storable actions might have their <strong>callbacks invoked twice</strong>:</p>
<ul>
<li>first with cached data</li>
<li>with updated data from the server when when <code>age &gt;= refreshAge</code> (30 secs)</li>
</ul>
</li>
<li><p>Keys used in determining an identical action:</p>
<ul>
<li>Apex controller name</li>
<li>Method name (<code>@AuraEnabled</code>)</li>
<li>Method parameter values (method signature and parameter values)</li>
</ul>
</li>
</ol>
<h2 id="lightning-data-services-lds-forcerecorddata">Lightning Data Services (LDS): <code>force:recordData</code></h2>
<p>Provides well-connected Components</p>
<ul>
<li><p>Component A asks LDS:  <code>[Contact.id, Contact.Name, Contact.Phone]</code></p>
<ul>
<li>LDS gets that data from the Server and <strong>Caches</strong> it</li>
</ul>
</li>
<li><p>Component B asks LDS:  <code>[Contact.id, Contact.Name, Contact.Phone]</code>  </p>
<ul>
<li>LDS gets that data <strong>from the Cache</strong></li>
</ul>
</li>
</ul>
<ul>
<li>Component C asks LDS:  <code>[Contact.id, Contact.Name, Contact.Phone, Contact.MobilePhone]</code>  <ul>
<li>LDS gets that data from the Cache and fetches the delta - extra field <code>Contact.MobilePhone</code> and <strong>Caches</strong> it</li>
</ul>
</li>
</ul>
<p><img src="img/lds-1.gif" alt="action.setStorable-1"></p>
<h3 id="component-a-markup">Component A Markup</h3>
<pre><code class="lang-xml">
<span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span> <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;force:hasRecordId, flexipage:availableForAllPageTypes&quot;</span> <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;recordId&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Id&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;contact&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;MyContact__c&quot;</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">force:recordData</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;dataService&quot;</span>
            <span class="hljs-attr">recordId</span>=<span class="hljs-string">&quot;{!v.recordId}&quot;</span>
            <span class="hljs-attr">targetFields</span>=<span class="hljs-string">&quot;{!v.contact}&quot;</span>
            <span class="hljs-attr">fields</span>=<span class="hljs-string">&quot;[&apos;Id, &apos;Name&apos;, &apos;Phone__c&apos;]&quot;</span>

    /&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<h3 id="component-b-markup">Component B Markup</h3>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span> <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;force:hasRecordId, flexipage:availableForAllPageTypes&quot;</span> <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;recordId&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Id&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;contact&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;MyContact__c&quot;</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">force:recordData</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;dataService&quot;</span>
            <span class="hljs-attr">recordId</span>=<span class="hljs-string">&quot;{!v.recordId}&quot;</span>
            <span class="hljs-attr">targetFields</span>=<span class="hljs-string">&quot;{!v.contact}&quot;</span>
            <span class="hljs-attr">fields</span>=<span class="hljs-string">&quot;[&apos;Id, &apos;Name&apos;, &apos;Phone__c&apos;]&quot;</span>

    /&gt;</span>

    <span class="hljs-comment">&lt;!-- other stuff --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<h3 id="component-c-markup">Component C Markup</h3>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span> <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;force:hasRecordId, flexipage:availableForAllPageTypes&quot;</span> <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;recordId&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Id&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;contact&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;MyContact__c&quot;</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">force:recordData</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;dataService&quot;</span>
            <span class="hljs-attr">recordId</span>=<span class="hljs-string">&quot;{!v.recordId}&quot;</span>
            <span class="hljs-attr">targetFields</span>=<span class="hljs-string">&quot;{!v.contact}&quot;</span>
            <span class="hljs-attr">fields</span>=<span class="hljs-string">&quot;[&apos;Id, &apos;Name&apos;, &apos;Phone__c&apos;, &apos;Mobile_Phone__c&apos;]&quot;</span>

    /&gt;</span>

    <span class="hljs-comment">&lt;!-- other stuff --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<h3 id="data-binding">Data Binding</h3>
<h3 id="component-with-bound-expression---2-way-data-binding">Component with Bound Expression - 2-way data-binding</h3>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span> <span class="hljs-attr">controller</span>=<span class="hljs-string">&quot;ContactCtrl&quot;</span> <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;force:hasRecordId, flexipage:availableForAllPageTypes&quot;</span> 
                <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;contacts&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Contact[]&quot;</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">aura:iteration</span> <span class="hljs-attr">items</span>=<span class="hljs-string">&quot;{!v.contacts}&quot;</span> <span class="hljs-attr">var</span>=<span class="hljs-string">&quot;contact&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--  <span class="hljs-doctag">Note:</span> {!contact.firstName} : this is 2-way data-binding to var contact--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{!contact.firstName}&quot;</span> /&gt;</span>
        <span class="hljs-comment">&lt;!--
          - if user changes this value in the input element, the model (var contact) changes automatically 

          - At framework level we need to setup 2 event-listeners - this is in a loop here, 
            so 2 event-listeners per iterations...

          - this is expensive!

            // handle Model to View change
            1. contact.addEventListener(&quot;change&quot;, function(event) {
                 // put into in VIEW - input element
                 inputElement.value = contact.firstName;
               }
            // handle View to Model change 
            2. inputElment.addEventListener(&quot;change&quot;, function(event) {
                 // update the model from value from the input element
                 contact.firstName = inputElement.value;
               }

        --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">aura:iteration</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<h3 id="component-with-unbound-expression---1-time-data-binding">Component with unBound Expression - 1-TIME data-binding</h3>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span> <span class="hljs-attr">controller</span>=<span class="hljs-string">&quot;ContactCtrl&quot;</span> <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;force:hasRecordId, flexipage:availableForAllPageTypes&quot;</span> 
                <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;contacts&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Contact[]&quot;</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">aura:iteration</span> <span class="hljs-attr">items</span>=<span class="hljs-string">&quot;{!v.contacts}&quot;</span> <span class="hljs-attr">var</span>=<span class="hljs-string">&quot;contact&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--  <span class="hljs-doctag">Note:</span> {#contact.firstName} : this is 1-TIME data-binding to var contact--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span> {#contact.firstName} <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-comment">&lt;!--
         - this is 1-TIME data-binding
         - cheap! 

        --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">aura:iteration</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<p><strong>Note</strong>:</p>
<p>Don&#x2019;t use a component&#x2019;s <code>init</code> event and client-side controller to initialize an attribute that is used in an unbound expression.</p>
<p>The attribute will not be initialized. Use a bound expression instead. </p>
<h2 id="modular-code">Modular Code</h2>
<h3 id="share-code-and-data-between-components">Share Code and Data Between Components</h3>
<h3 id="js-library">JS library</h3>
<h3 id="write-simple--simple-counter-js-library">Write simple  simple counter JS library</h3>
<pre><code class="lang-js"><span class="hljs-comment">// simple Counter lib</span>

<span class="hljs-comment">// singleton</span>
<span class="hljs-built_in">window</span>.counter = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
   <span class="hljs-keyword">var</span> value = <span class="hljs-number">0</span>;
   <span class="hljs-keyword">return</span> { <span class="hljs-comment">// returns 2 functions</span>

       inc: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> ++value;
       },
       dec: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> --value;
       },
       getValue : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
           <span class="hljs-keyword">return</span> value;
       }
   }
} () );

<span class="hljs-comment">// non-singleton</span>
<span class="hljs-built_in">window</span>.counter2 = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> value = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">return</span> {
        inc : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> ++value; },
        dec : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> --value; },
        getValue: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> value; }
    };

 };
</code></pre>
<p><img src="img/lex-js-lib-1.gif" alt="lex-js-lib-1"></p>
<h3 id="counter-component-using-this-simple-js-library">Counter Component using this Simple JS library</h3>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span>  <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;flexipage:availableForAllPageTypes&quot;</span> 
                <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- require this js lib --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ltng:require</span> <span class="hljs-attr">scripts</span>=<span class="hljs-string">&quot;{!$Resource.gw19__Counter}&quot;</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- counter value --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;value&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Integer&quot;</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;help&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;String&quot;</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;Help!&quot;</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- component intialization 
    &lt;aura:handler name=&quot;init&quot; value=&quot;{!this}&quot; action=&quot;{!c.doInit}&quot; /&gt;
    --&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Value: {!v.value}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&apos;slds-button slds-button_outline-brand&apos;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.getValue}&quot;</span>&gt;</span> Get Value <span class="hljs-tag">&lt;/<span class="hljs-name">lightning:button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&apos;slds-button slds-button_brand&apos;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.inc}&quot;</span>&gt;</span> Increment Value <span class="hljs-tag">&lt;/<span class="hljs-name">lightning:button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&apos;slds-button slds-button_destructive&apos;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.dec}&quot;</span>&gt;</span> Decrement Value <span class="hljs-tag">&lt;/<span class="hljs-name">lightning:button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&apos;slds-button slds-button_success&apos;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.showHelp}&quot;</span>&gt;</span> Help <span class="hljs-tag">&lt;/<span class="hljs-name">lightning:button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>/&gt;</span>{!v.help}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<p><strong> Component Controller </strong></p>
<pre><code class="lang-js">
({
    doInit : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
         component.set(<span class="hljs-string">&apos;v.value&apos;</span>, <span class="hljs-number">0</span>);
    },
    getValue : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> value = <span class="hljs-built_in">window</span>.counter.getValue();
        component.set(<span class="hljs-string">&apos;v.value&apos;</span>, value);

    },

    inc : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> value = <span class="hljs-built_in">window</span>.counter.inc();
        component.set(<span class="hljs-string">&apos;v.value&apos;</span>, value);
    },

    dec : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> value = <span class="hljs-built_in">window</span>.counter.dec();
        component.set(<span class="hljs-string">&apos;v.value&apos;</span>, value);
    },

    showHelp : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> help = <span class="hljs-string">&quot;Here comes help content for this component...&quot;</span>;
        component.set(<span class="hljs-string">&apos;v.help&apos;</span>, help);
    },




})
</code></pre>
<p><strong> Testing App </strong></p>
<pre><code class="lang-xml">
<span class="hljs-tag">&lt;<span class="hljs-name">aura:application</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;force:slds&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">gw19:Counter</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aura:application</span>&gt;</span>
</code></pre>
<p><strong> Testing App CSS </strong></p>
<pre><code class="lang-css">
<span class="hljs-selector-class">.THIS</span> {
    <span class="hljs-attribute">padding</span>:<span class="hljs-number">10px</span>;
    <span class="hljs-attribute">margin</span>:<span class="hljs-number">30px</span>;
    <span class="hljs-attribute">border</span>:<span class="hljs-number">5px</span> solid steelblue;
    <span class="hljs-attribute">border-radius</span>:<span class="hljs-number">10px</span>;
}
</code></pre>
<p><strong>Demo with Aura App</strong></p>
<p><img src="img/lex-js-lib-2.gif" alt="lex-js-lib-1"></p>
<p><strong>Demo in Lightning Page built with App Builder</strong></p>
<p><img src="img/lex-js-lib-3.gif" alt="lex-js-lib-1"></p>
<h3 id="counter2-component-using-this-simple-js-library">Counter2 Component using this Simple JS library</h3>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span>  <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;flexipage:availableForAllPageTypes&quot;</span> 
                <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- require this js lib  and call jsLoaded to create the window.counter2 object
         so window.counter2 object is unique to this component instance - not a singleton

    --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ltng:require</span> <span class="hljs-attr">scripts</span>=<span class="hljs-string">&quot;{!$Resource.gw19__Counter}&quot;</span>
                  <span class="hljs-attr">afterScriptsLoaded</span>=<span class="hljs-string">&quot;{!c.jsLoaded}&quot;</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- counter value --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;value&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Integer&quot;</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;help&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;String&quot;</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;Help!&quot;</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- component intialization 
    &lt;aura:handler name=&quot;init&quot; value=&quot;{!this}&quot; action=&quot;{!c.doInit}&quot; /&gt;
    --&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Value: {!v.value}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&apos;slds-button slds-button_outline-brand&apos;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.getValue}&quot;</span>&gt;</span> Get Value <span class="hljs-tag">&lt;/<span class="hljs-name">lightning:button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&apos;slds-button slds-button_brand&apos;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.inc}&quot;</span>&gt;</span> Increment Value <span class="hljs-tag">&lt;/<span class="hljs-name">lightning:button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&apos;slds-button slds-button_destructive&apos;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.dec}&quot;</span>&gt;</span> Decrement Value <span class="hljs-tag">&lt;/<span class="hljs-name">lightning:button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">lightning:button</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&apos;slds-button slds-button_success&apos;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;{!c.showHelp}&quot;</span>&gt;</span> Help <span class="hljs-tag">&lt;/<span class="hljs-name">lightning:button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>/&gt;</span>{!v.help}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<p><strong> Component Controller </strong></p>
<pre><code class="lang-js">
({
    doInit : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
         component.set(<span class="hljs-string">&apos;v.value&apos;</span>, <span class="hljs-number">0</span>);
    },

    jsLoaded: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-comment">// here create a new object for window.counter2 and</span>
        <span class="hljs-comment">//  store in component.counter object</span>
        component.counter = <span class="hljs-keyword">new</span> <span class="hljs-built_in">window</span>.counter2();

    },

    getValue : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> value = component.counter.getValue();
        component.set(<span class="hljs-string">&apos;v.value&apos;</span>, value);

    },

    inc : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> value = component.counter.inc();
        component.set(<span class="hljs-string">&apos;v.value&apos;</span>, value);
    },

    dec : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> value = component.counter.dec();
        component.set(<span class="hljs-string">&apos;v.value&apos;</span>, value);
    },

    showHelp : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> help = <span class="hljs-string">&quot;Here comes help content for this component...&quot;</span>;
        component.set(<span class="hljs-string">&apos;v.help&apos;</span>, help);
    },




})
</code></pre>
<p><strong>Demo in Lightning Page built with App Builder showing both singleton and non-singleton window.counter </strong></p>
<p><img src="img/lex-js-lib-4.gif" alt="lex-js-lib-1"></p>
<h3 id="non-visual-component---dataservice-components">Non-visual component - DataService components</h3>
<pre><code class="lang-&lt;aura:method&gt;```">
Use &lt;aura:method&gt; to define a method as part of a component&apos;s API. This enables you to directly call a method in a **component&#x2019;s client-side controller instead of firing and handling a component event**.

 Using &lt;aura:method&gt; simplifies the code needed for a parent component to **call a method on a child component** that it contains.


**AccountDataService component - has no UI - non-visual**

```xml
&lt;aura:component  controller=&quot;AccountCtrl&quot;&gt;

  &lt;!-- this findAll method another component can invoke --&gt;
   &lt;aura:method name=&quot;findAll&quot; action=&quot;{!c.getAccounts}&quot;&gt;
      &lt;aura:attribute name=&quot;callback&quot; type=&quot;function&quot; /&gt;
   &lt;/aura:method&gt;

&lt;/aura:component&gt;
</code></pre>
<p><strong>Server-side controller AccountCtrl</strong></p>
<pre><code class="lang-java">
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountCtrl</span> </span>{

    <span class="hljs-meta">@AuraEnabled</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Account&gt; <span class="hljs-title">svrGetAllAccounts</span><span class="hljs-params">()</span></span>{
        List&lt;Account&gt; accounts = [SELECT Name FROM Account];
        <span class="hljs-keyword">return</span> accounts;  
    }
}
</code></pre>
<p><strong>AccountDataService component controller</strong></p>
<pre><code class="lang-js">
({
   getAccounts : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">component, event, helper</span>) </span>{
       <span class="hljs-keyword">var</span> params = event.getParam(<span class="hljs-string">&quot;arguments&quot;</span>);
       <span class="hljs-keyword">var</span> action = component.get(<span class="hljs-string">&quot;c.svrGetAllAccounts&quot;</span>);
       action.setStorable();

       action.setCallback (<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>)</span>{
           <span class="hljs-keyword">if</span> (response.getState() === <span class="hljs-string">&apos;SUCCESS&apos;</span>) {
               params.callback(<span class="hljs-literal">null</span>, response.getReturnValue() );
           } <span class="hljs-keyword">else</span> {
               params.callback(response.getError() );
           }
       });

       $A.enqueueAction(action);
   }

})
</code></pre>
<p><strong>AccountList component using AccountDataService</strong></p>
<pre><code class="lang-xml">
<span class="hljs-comment">&lt;!-- has no controller but it uses AccountDataService

   <span class="hljs-doctag">NOTE:</span> Generally Component can have only one Service-side controller

   This way a component can have make use many DataServices

 --&gt;</span>
<span class="hljs-comment">&lt;!-- has no controller but it uses AccountDataService

   <span class="hljs-doctag">NOTE:</span> Generally Component can have only one Service-side controller

   This way a component can have make use many DataServices

 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span>  <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;flexipage:availableForAllPageTypes&quot;</span> 
                <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;accounts&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Account[]&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:handler</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;init&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{!this}&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;{!c.doInit}&quot;</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">gw19:AccountDataService</span> <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;ads&quot;</span> /&gt;</span>
    <span class="hljs-comment">&lt;!--
     &lt;gw19:ContactDataService aura:id=&quot;cds&quot; /&gt;
     --&gt;</span>
    <span class="hljs-comment">&lt;!--
     <span class="hljs-doctag">NOTE:</span> Generally Component can have only one Service-side controller

     This way a component can have make use many DataServices
    --&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aura:iteration</span> <span class="hljs-attr">items</span>=<span class="hljs-string">&quot;{!v.accounts}&quot;</span> <span class="hljs-attr">var</span>=<span class="hljs-string">&quot;account&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>{!account.Name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">aura:iteration</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>


<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<p><strong>Controller for AccountList Component</strong></p>
<pre><code class="lang-js">
({

    doInit : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">component, event, helper</span>) </span>{
        <span class="hljs-keyword">var</span> ads = component.find(<span class="hljs-string">&quot;ads&quot;</span>); <span class="hljs-comment">// get the AccountDataService</span>
        <span class="hljs-comment">// call findAll method on  AccountDataService</span>
        ads.findAll($A.getCallback( <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error, data</span>) </span>{
          component.set(<span class="hljs-string">&apos;v.accounts&apos;</span>, data);  
        }));
    }
})
</code></pre>
<p><strong>TestApp</strong></p>
<pre><code class="lang-xml">
<span class="hljs-tag">&lt;<span class="hljs-name">aura:application</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;force:slds&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">gw19:Counter</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">gw19:Counter2</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">gw19:AccountList</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aura:application</span>&gt;</span>
</code></pre>
<h2 id="events">Events</h2>
<p><img src="img/lex-events-1.png" alt="Events type selection"></p>
<ul>
<li>Application-Events are broadcast time : Costly</li>
<li><p>If Component-B is included in Component-A  (have a parent-child relationship):</p>
<ul>
<li>Component-B was to say something to Component-A - Use Component-Event, not Application-Event</li>
</ul>
</li>
<li><p>If Component-A and Component-B do not have a parent-child relationship:</p>
<ul>
<li>Component-B was to say something to Component-A - Use Application-Event</li>
<li>This is typical App-Builder use case</li>
</ul>
</li>
<li><p>If you using Application-level outside the App-Builder use-case, think twice and consider Component-Events</p>
</li>
<li><p>If two systems: System-A and System-B want to communicate each other, user Platform Events</p>
</li>
</ul>
<p><img src="img/lex-dataservice-1.png" alt="DataService demo"></p>
<p><hr>
<img src="img/lex-dataservice-2.png" alt="DataService demo"></p>
<h3 id="system-to-system-event---platform-event-and-component-event-example">System to System event - platform event and Component-Event Example</h3>
<p><strong>Subscriber component</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span>  <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;flexipage:availableForAllPageTypes,flexipage:availableForRecordHome&quot;</span> 
                 <span class="hljs-attr">controller</span>=<span class="hljs-string">&quot;SessionCtrl&quot;</span>
                <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>

<span class="hljs-comment">&lt;!--

SessionController provides svrGetSessionId()
--&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;eventName&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;String&quot;</span> /&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">ltng:require</span> <span class="hljs-attr">scripts</span>=<span class="hljs-string">&quot;{!$Resource.cometd + &apos;/cometd.js&apos; } &quot;</span> 
       <span class="hljs-attr">afterScriptsLoaded</span>=<span class="hljs-string">&quot;{!c.onJSLoaded}&quot;</span>

/&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">aura:registerEvent</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;onmessage&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;gw19:MessageEvent&quot;</span> /&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<p><strong>Subscriber component controller</strong></p>
<pre><code class="lang-js">
({
   onJSLoaded: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">component, event, helper</span>) </span>{
       <span class="hljs-keyword">var</span> action = component.get(<span class="hljs-string">&quot;c.svrGetSessionId&quot;</span>);

       action.setCallback(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
           <span class="hljs-comment">// get sessionId</span>
           <span class="hljs-keyword">var</span> sessionId = response.getReturnValue();
           <span class="hljs-comment">// get the cometd object</span>
           <span class="hljs-keyword">var</span> cometd = <span class="hljs-keyword">new</span> <span class="hljs-built_in">window</span>.org.cometd.CometD();
           <span class="hljs-comment">// now configure the cometd object</span>
           cometd.configure({
                url: <span class="hljs-built_in">window</span>.location.protocol + <span class="hljs-string">&apos;//&apos;</span> +
                     <span class="hljs-built_in">window</span>.location.hostname +
                     <span class="hljs-string">&apos;/cometd/41.0/&apos;</span>,
                requestHeader: { Authorization: <span class="hljs-string">&apos;OAuth &apos;</span> + sessionId },
                appendMessageTypeToURL : <span class="hljs-literal">false</span>

           });

           <span class="hljs-comment">// comet handshake</span>
           cometd.handshake($A.getCalback (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">status</span>)</span>{
               <span class="hljs-keyword">if</span> (status.successful) {
                   <span class="hljs-keyword">var</span> eventName = component.get(<span class="hljs-string">&quot;v.eventName&quot;</span>);
                   <span class="hljs-comment">// eventName will Mix_Approved__e here...</span>
                   cometd.subscribe(<span class="hljs-string">&apos;/event/&apos;</span> + eventName , $A.getCallback(
                       <span class="hljs-comment">// get the message from the Platform Event (Mix_Approved__e)</span>
                       <span class="hljs-comment">//   and fire the Component-event (onmessage)</span>
                       <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> message</span>) </span>{
                           <span class="hljs-built_in">console</span>.log(message);
                           <span class="hljs-keyword">var</span> messageEvent = component.getEvent(<span class="hljs-string">&quot;onmessage&quot;</span>);
                           messageEvent.setParam(<span class="hljs-string">&quot;message&quot;</span>, message);
                           <span class="hljs-comment">//fire: component-event the MixPath component listens to this component-event</span>
                           <span class="hljs-comment">//     after receiving this event it changes the step in the Path</span>
                           messageEvent.fire();
                       }
                   ) 

                   );
               }

           }));



       }); <span class="hljs-comment">// action.setCallback...</span>

       $A.enqueueAction(action);



   },

})
</code></pre>
<p><strong>SessionCtrl - server-side controller</strong></p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SessionCtrl</span> </span>{
    <span class="hljs-meta">@AuraEnabled</span>
    <span class="hljs-comment">// exposes this method to Lightning component controller</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">svrGetSessionId</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">// uses std UserInfo utility class to get sessionId</span>
        <span class="hljs-keyword">return</span> UserInfo.getSessionId();
    }
}
</code></pre>
<p><strong>MixPath Component</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">aura:component</span>  <span class="hljs-attr">implements</span>=<span class="hljs-string">&quot;flexipage:availableForAllPageTypes,flexipage:availableForRecordHome&quot;</span> 
                <span class="hljs-attr">access</span>=<span class="hljs-string">&quot;global&quot;</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;recordId&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Id&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;record&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Object&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aura:attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;steps&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;String[]&quot;</span> <span class="hljs-attr">default</span> =<span class="hljs-string">&quot;[&apos;Draft&apos;, &apos;Submitted to Mfr&apos;, &apos;Approved by Mfr&apos;, &apos;Ordered&apos;]&quot;</span> /&gt;</span>

   <span class="hljs-comment">&lt;!-- The Subscriber will translate this Platform event(Mix_Approved__e) to Component-Event (onMixApproved)

   --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">gw19:Subscriber</span> <span class="hljs-attr">eventName</span>=<span class="hljs-string">&quot;Mix_Approved__e&quot;</span> <span class="hljs-attr">onmessage</span>=<span class="hljs-string">&quot;{!c.onMixApproved}&quot;</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">force:recordData</span>
          <span class="hljs-attr">aura:id</span>=<span class="hljs-string">&quot;mixRecord&quot;</span>
          <span class="hljs-attr">recordId</span>=<span class="hljs-string">&quot;{!v.recordId}&quot;</span>
          <span class="hljs-attr">targetFields</span>=<span class="hljs-string">&quot;{!v.record}&quot;</span>
          <span class="hljs-attr">fields</span>=<span class="hljs-string">&quot;[&apos;Id&apos;, &apos;Status__c&apos;]&quot;</span>

          <span class="hljs-attr">recordUpdated</span>=<span class="hljs-string">&quot;{!c.onRecordUpdated}&quot;</span>
     /&gt;</span>

     <span class="hljs-tag">&lt;<span class="hljs-name">gw:Path</span> <span class="hljs-attr">steps</span>=<span class="hljs-string">&quot;{!v.steps}&quot;</span> <span class="hljs-attr">currentStep</span>=<span class="hljs-string">&quot;{!v.record.Status__c}&quot;</span>
                <span class="hljs-attr">stepChange</span>=<span class="hljs-string">&quot;{!c.onStepChange}&quot;</span>

     /&gt;</span>





<span class="hljs-tag">&lt;/<span class="hljs-name">aura:component</span>&gt;</span>
</code></pre>
<p><strong>Demo of using Platform Events and Component Events</strong></p>
<ul>
<li>Subscribe to the event created by the Manufacturing event - Platform Event</li>
<li>On the receipt that Platform Event, a component-event is fired</li>
</ul>
<p><img src="img/ltex-pe-1.gif" alt="PE demo"></p>
<h2 id="resources">Resources</h2>
<ul>
<li><p><a href="https://developer.salesforce.com/docs/atlas.en-us.lightning.meta/lightning/expr_data_binding.htm" target="_blank">Data Binding Between Components
</a></p>
</li>
<li><p><a href="https://developer.salesforce.com/docs/atlas.en-us.lightning.meta/lightning/js_libs_platform.htm" target="_blank">Using External JavaScript Libraries</a></p>
</li>
<li><p><a href="https://developer.salesforce.com/docs/atlas.en-us.lightning.meta/lightning/ref_tag_method.htm" target="_blank">aura:method</a></p>
</li>
<li><p><a href="https://mohan-chinnappan-n.github.io/sfdc/pevents.html#/26" target="_blank">Subscribe event message with Cometd example</a></p>
</li>
</ul>
<h2 id="videos">Videos</h2>
<h3 id="advanced-lightning-components">Advanced Lightning Components</h3>
 <iframe id="ytplayer" type="text/html" width="640" height="360" src="https://www.youtube.com/embed/G931jWBnxHU?autoplay=0 &amp;fs=1" frameborder="0"></iframe>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../chap-30/body.html" class="navigation navigation-prev " aria-label="Previous page: Lightning Out">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../chap-31/sc.html" class="navigation navigation-next " aria-label="Next page: Secure Coding">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Performance Tips","level":"5.1","depth":1,"next":{"title":"Secure Coding","level":"6.1","depth":1,"path":"chap-31/sc.md","ref":"chap-31/sc.md","articles":[]},"previous":{"title":"Lightning Out","level":"4.3","depth":1,"path":"chap-30/body.md","ref":"chap-30/body.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["youtube","adsense","livereload"],"pluginsConfig":{"youtube":{},"livereload":{},"search":{},"adsense":{"client":"ca-pub-5381915020912221","slot":"8656817479","format":"auto","element":".page-inner section","position":"top"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"chap-28/perf.md","mtime":"2018-08-06T12:54:43.062Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2018-08-10T20:39:06.437Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-adsense/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

