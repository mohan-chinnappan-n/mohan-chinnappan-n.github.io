<!DOCTYPE html>
<html lang="en" ng-app='app'>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>OAuth Redirect</title>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
 <link rel="stylesheet" href="//code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />

 <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" />
 <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular.js"></script>
 <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-touch.js"></script>
 <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-animate.js"></script>
 <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-messages.js"></script>
 <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-sanitize.js"></script>
 <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-utils/0.1.1/angular-ui-utils.min.js"></script>

 <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

 <link rel="stylesheet" href="../../css/navbar-blue.css">

 <script src="https://cdn.rawgit.com/zenorocha/clipboard.js/master/dist/clipboard.min.js"></script>
 <style media="screen">
 #code {
     background: #272822;
    font-family: Monaco, Arial;
    font-size: 12px;
    color: #ffe;
    border-radius: 8px;
    padding: 10px
}
 </style>

<script type="text/javascript">
(function() {
    'use strict';
    var MODULE_NAME = 'ngclipboard';
    var angular, ClipboardJS;

    // Check for CommonJS support
    if (typeof module === 'object' && module.exports) {
      angular = require('angular');
      ClipboardJS = require('clipboard');
      module.exports = MODULE_NAME;
    } else {
      angular = window.angular;
      ClipboardJS = window.ClipboardJS;
    }

    angular.module(MODULE_NAME, []).directive('ngclipboard', function() {
        return {
            restrict: 'A',
            scope: {
                ngclipboardSuccess: '&',
                ngclipboardError: '&'
            },
            link: function(scope, element) {
                //constructor for clipboardjs changed to ClipboardJS
                var clipboard = new ClipboardJS(element[0]);

                clipboard.on('success', function(e) {
                  scope.$apply(function () {
                    scope.ngclipboardSuccess({
                      e: e
                    });
                  });
                });

                clipboard.on('error', function(e) {
                  scope.$apply(function () {
                    scope.ngclipboardError({
                      e: e
                    });
                  });
                });

                element.on('$destroy', function() {
                    clipboard.destroy();
                });

            }
        };
    });
})();

</script>


</head>
<body ng-controller="MainCtrl" class="container">
<hr/>

<div class="row">
  <div class="col-lg-12">
    <input class="form-control"  placeholder="Enter URI" ng-model='uri' ng-change='updateCode()'/>
    <textarea rows='3' cols='160' id='code'>
{{code}}
    </textarea>
    <hr/>

    <button class="btn btn-primary" ngclipboard data-clipboard-action="copy" data-clipboard-target="#code">
       <i class="glyphicon glyphicon-copy"></i> Copy to clipboard
    </button>
     <a class="btn btn-info" href="bobj-editor.html">Redirect</a>
 </div>
</div>

<script type="text/javascript">
var app = angular.module('app',  ['ngclipboard']);
var GScope;
app.controller('MainCtrl', function($scope) {
  GScope = $scope;
  $scope.apiVersion = 'v42.0';
  $scope.uri = 'limits';

  $scope. cnpListener = function() {
		 document.getElementById('code').select();
     document.execCommand('copy');
}


  var query;
  if (location.search)  query = location.search.substr(1);
  if (location.href.indexOf('#') !== -1) query = location.href.split('#')[1]

  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  })
  $scope.urlParams = result;
  window.localStorage['urlParams'] = angular.toJson(  $scope.urlParams);


  if ( result.code ) { $scope.oauthCode = result.code }
  if ( result.access_token ) { $scope.oauthToken = result.access_token }

  $scope.updateCode = function() {
      $scope.code = "curl "  +  $scope.urlParams.instance_url + "/services/data/" + $scope.apiVersion + "/" + $scope.uri +  " -H 'Authorization: Bearer "
                + $scope.urlParams.access_token + "' | jq"
  }

  $scope.updateCode();



});
</script>

</body>
</html>
